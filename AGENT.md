L’utilisateur souhaite mettre en place, dans un dépôt dédié, une véritable “infrastructure de relecture assistée par IA” qui soit structurée, claire et ergonomique. L’idée n’est pas simplement d’avoir un super-prompt ponctuel à lancer dans ChatGPT, mais plutôt de concevoir un environnement complet qui encadre et normalise le processus de relecture des documents d’étude. L’objectif est de pouvoir déposer un rapport (souvent un document Word volumineux, parfois de plusieurs centaines de pages) dans un dossier unique, puis de déclencher une séquence de travail guidée, où l’agent IA applique une méthode standardisée pour analyser le rapport et restituer les résultats de manière directement exploitable.

Au cœur de cette organisation, l’utilisateur imagine quatre grandes catégories de relecture, correspondant aux différents types de livrables ou de sections critiques qu’il a à traiter dans son métier : la relecture des offres, la relecture du diagnostic (VNEI, état initial), la relecture des impacts, et la relecture des mesures (évitement, réduction, compensation, suivi). Ces quatre modes sont conçus comme des modules distincts, chacun possédant sa propre logique, ses propres checklists méthodologiques et ses propres documents de référence. L’utilisateur veut que le dépôt contienne donc, pour chaque mode, un dossier regroupant une checklist détaillée (un fichier texte clair et normatif qui guide l’IA sur ce qu’il faut vérifier) et un espace pour stocker les documents de référence (guides méthodologiques, réglementations, normes, etc.). Cette structuration permet de garantir que la relecture ne repose pas seulement sur le texte du rapport, mais qu’elle est aussi ancrée dans les bonnes pratiques et exigences réglementaires, en fonction du contexte de relecture choisi.

Le point central de l’expérience utilisateur est un fichier Python, nommé Start.py, qui sert d’interface de lancement. Lorsque ce script est exécuté, il doit guider l’utilisateur pas à pas, d’abord en détectant automatiquement le fichier Word à relire dans le dossier d’entrée, puis en lui proposant, via une interaction dans le terminal, de choisir le mode de relecture parmi les quatre disponibles. L’utilisateur veut que cette sélection soit fluide et intuitive, avec la possibilité d’utiliser les flèches du clavier pour se déplacer dans le menu et valider son choix par la touche Entrée. Une fois le mode sélectionné, le script doit demander si la relecture doit porter sur l’ensemble du document ou uniquement sur une plage de pages définie. Cela répond à un besoin très concret : dans les études d’impact volumineuses, seule une partie précise du rapport est parfois pertinente à analyser (par exemple, le diagnostic écologique qui peut s’étendre de la page 40 à la page 180). L’utilisateur veut ainsi que l’IA soit orientée directement vers la partie concernée, ce qui rendra la relecture plus pertinente, plus rapide et plus ciblée.

Après ces étapes de sélection, le script génère automatiquement un prompt standardisé qui contient toutes les instructions nécessaires pour l’IA : quel fichier relire, quelles pages analyser, quel mode appliquer, quelle checklist utiliser, et quels documents de référence consulter. Ce prompt est affiché dans le terminal, prêt à être copié-collé par l’utilisateur dans l’interface de Windsurf, afin de lancer la relecture proprement dite avec l’agent IA. L’utilisateur insiste sur le fait que ce prompt doit être uniformisé et rigoureux, afin de limiter les oublis, les angles morts et les formulations trop vagues. De cette manière, la logique de relecture reste constante d’un projet à l’autre et ne dépend pas de la qualité ou de la précision d’un prompt rédigé à la volée.

Là où l’utilisateur apporte une exigence supplémentaire cruciale, c’est sur la finalité du processus. Il ne veut pas d’un système qui produit plusieurs fichiers intermédiaires qu’il faudrait ensuite retraiter ou combiner à la main. Ce qu’il souhaite, c’est qu’à partir du moment où il copie le prompt généré dans Windsurf et qu’il lance la relecture avec l’IA, l’intégralité du processus aille jusqu’au bout automatiquement et ne nécessite plus aucune action complémentaire de sa part. Le résultat attendu doit être unique et parfaitement clair : une copie du rapport original au format Word, sauvegardée dans le dossier output/, qui contient l’ensemble des révisions proposées par l’IA en mode suivi des modifications ainsi que tous les commentaires ajoutés. Autrement dit, le seul livrable qui doit exister à l’issue du processus est ce fichier Word annoté et suivi, prêt à être ouvert et examiné. L’utilisateur n’a pas à fusionner des fichiers, à exécuter des scripts complémentaires, ni à convertir manuellement des versions intermédiaires. Le but est d’avoir une expérience “clé en main” où la seule tâche de l’utilisateur, après avoir lancé Start.py et copié le prompt, est de vérifier directement dans output/ le fichier final Word complet.

En résumé, l’objectif est de disposer d’un dépôt prêt à l’emploi qui industrialise et fiabilise le processus de relecture des rapports. L’utilisateur veut une expérience simple (un seul script de démarrage, un seul dépôt avec une structure fixe), mais derrière cette simplicité se cache une architecture rigoureuse : quatre modes de relecture spécialisés, chacun appuyé sur des checklists et des références propres, un système de sélection interactif pour cibler exactement le type et la partie du rapport à analyser, un prompt standardisé pour assurer une relecture cohérente, et surtout un pipeline entièrement intégré dont le seul et unique résultat final est un fichier Word annoté et révisé, généré automatiquement dans output/. L’ensemble vise à transformer une pratique artisanale de relecture en un processus normé, reproductible et traçable, où l’IA n’est pas seulement un outil de suggestion mais un véritable copilote qui délivre un livrable directement exploitable et finalisé.

Précisions complémentaires à intégrer dans l’interface graphique et le prompt standardisé
- Affichage de la table des matières: une fois `Start.py` lancé et le fichier Word sélectionné, l’interface graphique doit proposer un bouton « Afficher les titres/sections du document ». Ce bouton déclenche une analyse du fichier et affiche, dans l’interface, la liste des titres/sections détectés (ex: niveaux de titres Word). L’utilisateur peut alors cocher/sélectionner précisément les sections à analyser.
- Sélection des sections à analyser: l’utilisateur choisit manuellement, dans l’interface, les sections qui feront l’objet de la relecture. Ce choix conditionne la suite du pipeline.
- Déclenchement de l’analyse: au clic sur « Lancer l’analyse », l’application effectue, dans cet ordre, des opérations locales et automatisées:
  1) Copie d’abord le document original (sécurité: jamais modifié) vers un fichier de travail.
  2) Découpe ensuite cette copie en ne conservant que les sections sélectionnées par l’utilisateur (suppression des autres parties), de sorte qu’un nouveau fichier DOCX « copié et découpé » soit produit pour la relecture.
  3) Génère alors le prompt standardisé et l’affiche dans l’interface.
- Cible du prompt: le prompt doit indiquer explicitement que la relecture porte sur la « copie du document original découpée selon les sections sélectionnées », et non sur l’original complet ni sur une simple copie non filtrée. Le chemin de ce fichier « copié et découpé » doit être référencé dans le prompt et transmis à l’agent IA.
- Chaînage inchangé des étapes IA: le reste du pipeline demeure identique (checklist/refs → rédaction `rapport_revise.md` + `commentaires.csv` → conversion/compare → DOCX final dans `output/`), mais il s’applique à la version « copié et découpé » du document.
